fileFormatVersion: 2
guid: b8cdf2ca095fa4b65a277da8f0d19d4d
importerOverride:
  nativeImporterType: 2089858483
  scriptedImporterType:
    serializedVersion: 2
    Hash: 89072204048b7087d871d10c191cb608
ScriptedImporter:
  internalIDToNameTable: []
  externalObjects: {}
  serializedVersion: 2
  userData: 
  assetBundleName: 
  assetBundleVariant: 
  script: {fileID: -1123457745, guid: 54cf806323ffe4418a4ce4cc63fe6b9d, type: 3}
  isAssemblyDeclarations: 0
  assembly: 
  generateAllTypes: 1
  types: []
  generateWrapper: 0
  overrideWrapperTypes: 0
  wrapperTypes: []
  WrapperFilters: []
  wrapperOutputDirectory: Generated
  compiledResult: '{"source":"\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\",
    { value: true });\r\nconst ZEPETO_Script_1 = require(\"ZEPETO.Script\");\r\nconst
    UnityEngine_1 = require(\"UnityEngine\");\r\nconst ZEPETO_Multiplay_1 = require(\"ZEPETO.Multiplay\");\r\nconst
    MultiplayManager_1 = require(\"../Common/MultiplayManager\");\r\nconst ZEPETO_World_1
    = require(\"ZEPETO.World\");\r\nconst SyncIndexManager_1 = require(\"../Common/SyncIndexManager\");\r\nconst
    TransformSyncHelper_1 = require(\"../Transform/TransformSyncHelper\");\r\nconst
    ToolClassGather_1 = require(\"../ToolClass/ToolClassGather\");\r\nclass AnimatorSyncHelper
    extends ZEPETO_Script_1.ZepetoScriptBehaviour {\r\n    get Id() {\r\n       
    return this._Id;\r\n    }\r\n    Start() {\r\n        const tcg = MultiplayManager_1.default.instance.gameObject?.GetComponent($typeof(ToolClassGather_1.default));\r\n       
    if (null === tcg) {\r\n            MultiplayManager_1.default.instance.gameObject.AddComponent($typeof(ToolClassGather_1.default));\r\n       
    }\r\n        ToolClassGather_1.default.Instance.AnimHelper.push(this.gameObject.GetComponent($typeof(AnimatorSyncHelper)));\r\n       
    this._animator = this.GetComponentInChildren($typeof(UnityEngine_1.Animator));\r\n       
    this._Id = this.GetComponent($typeof(TransformSyncHelper_1.default))?.Id ?? (SyncIndexManager_1.default.SyncIndex++).toString();\r\n       
    this._multiplay = UnityEngine_1.Object.FindObjectOfType($typeof(ZEPETO_World_1.ZepetoWorldMultiplay));\r\n       
    this._multiplay.add_RoomJoined((room) => {\r\n            this._room = room;\r\n           
    this.SyncMessageHandler();\r\n        });\r\n    }\r\n    Update() {\r\n       
    if (!this._isMasterClient)\r\n            return;\r\n        if (this._previousShortNameHash
    != this._animator.GetCurrentAnimatorStateInfo(0)?.shortNameHash) {\r\n           
    this.SendAnimator();\r\n            this._previousShortNameHash = this._stateInfo.shortNameHash;\r\n       
    }\r\n    }\r\n    ChangeOwner(ownerSessionId) {\r\n        if (null == this._room)\r\n           
    this._room = MultiplayManager_1.default.instance.room;\r\n        if (this._room.SessionId
    == ownerSessionId) {\r\n            this._isMasterClient = true;\r\n           
    this.SendAnimator();\r\n        }\r\n        else if (this._room.SessionId !=
    ownerSessionId && this._isMasterClient) {\r\n            this._isMasterClient
    = false;\r\n        }\r\n    }\r\n    SendAnimator() {\r\n        console.log(\"send\");\r\n       
    this._stateInfo = this._animator?.GetCurrentAnimatorStateInfo(0);\r\n       
    const clipNameHash = this._stateInfo.shortNameHash;\r\n        const clipNormalizedTime
    = this._stateInfo.normalizedTime;\r\n        const data = new ZEPETO_Multiplay_1.RoomData();\r\n       
    data.Add(\"Id\", this._Id);\r\n        data.Add(\"clipNameHash\", clipNameHash);\r\n       
    data.Add(\"clipNormalizedTime\", clipNormalizedTime);\r\n        this._room?.Send(\"SyncAnimator\",
    data.GetObject());\r\n    }\r\n    SyncMessageHandler() {\r\n        const ResponseId
    = \"ResponseAnimator\" + this._Id;\r\n        this._room.AddMessageHandler(ResponseId,
    (message) => {\r\n            this.GetSyncAnimator(message);\r\n        });\r\n   
    }\r\n    GetSyncAnimator(message) {\r\n        this._animator.Play(message.clipNameHash,
    0, message.clipNormalizedTime);\r\n    }\r\n}\r\nexports.default = AnimatorSyncHelper;\r\n//#
    sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQW5pbWF0b3JTeW5jSGVscGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiQW5pbWF0b3JTeW5jSGVscGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsaURBQXFEO0FBQ3JELDZDQUE2SDtBQUM3SCx1REFBZ0Q7QUFDaEQsaUVBQTBEO0FBQzFELCtDQUFrRDtBQUNsRCxpRUFBMEQ7QUFDMUQsMEVBQW1FO0FBQ25FLGtFQUEyRDtBQUUzRCxNQUFxQixrQkFBbUIsU0FBUSxxQ0FBcUI7SUFnQmpFLElBQUksRUFBRTtRQUNGLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQztJQUNwQixDQUFDO0lBRU8sS0FBSztRQUNULE1BQU0sR0FBRyxHQUFHLDBCQUFnQixDQUFDLFFBQVEsQ0FBQyxVQUFVLEVBQUUsWUFBWSxTQUFDLHlCQUFlLEVBQUcsQ0FBQztRQUNsRixJQUFHLElBQUksS0FBSyxHQUFHLEVBQUU7WUFDYiwwQkFBZ0IsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLFlBQVksU0FBQyx5QkFBZSxFQUFHLENBQUM7U0FDeEU7UUFDRCx5QkFBZSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsWUFBWSxTQUFDLGtCQUFrQixFQUFHLENBQUMsQ0FBQztRQUM3RixJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxzQkFBc0IsU0FBQyxzQkFBUSxFQUFHLENBQUM7UUFFekQsSUFBSSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsWUFBWSxTQUFDLDZCQUFtQixFQUFHLEVBQUUsRUFBRSxJQUFJLENBQUMsMEJBQWdCLENBQUMsU0FBUyxFQUFFLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUNyRyxJQUFJLENBQUMsVUFBVSxHQUFHLG9CQUFNLENBQUMsZ0JBQWdCLFNBQUMsbUNBQW9CLEVBQUcsQ0FBQztRQUNsRSxJQUFJLENBQUMsVUFBVSxnQkFBZSxDQUFDLElBQVUsRUFBRSxFQUFF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","assetPath":"Assets/Zepeto
    Multiplay Component/ZepetoScript/Transform/AnimatorSyncHelper.ts","manifest":{"properties":[],"name":"AnimatorSyncHelper","description":"","hasAnimatorMove":false},"isCompiled":true}'
  typescriptHash: e66101c3eb8643116415b5028c60121a
  onlyWriteTrigger: 0
